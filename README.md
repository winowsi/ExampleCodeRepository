# Read Write Lockè¯»å†™é”
**é€‚ç”¨äºé«˜å¹¶å‘ç¯å¢ƒä½¿ç”¨**

1ã€ä¸åŠ é”åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è¯»å†™
    
    static  class  MyCache{
        //ReadWriteLockçš„å®ç°ç±»ReentrantReadWriteLock
            private ReentrantReadWriteLock readWriteLock=new ReentrantReadWriteLock();
            //volatile ä¿è¯çº¿ç¨‹çš„å¯è§æ€§ ä¸ä¿è¯åŸå­æ€§ ç¦æ­¢æŒ‡ä»¤é‡æ’
            private static volatile Map<String,Object> map=new HashMap<>();
            //ä¸åŠ é”çš„å†™å…¥æ–¹æ³•
            private  static void set(String key ,Object value){
                //è·å–æ­£åœ¨å†™å…¥çº¿ç¨‹çš„åå­—
                System.out.println("çº¿ç¨‹"+Thread.currentThread().getName()+"\tæ­£åœ¨å†™å…¥...o(U_U)o...");
                map.put(key,value);
                //æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
                try { TimeUnit.MILLISECONDS.sleep(300); }catch (InterruptedException e) { e.printStackTrace(); }
                System.out.println("çº¿ç¨‹"+Thread.currentThread().getName()+"\tå†™å…¥å®Œæˆ...o(n_n)o...âœ…");
            }
            //ä¸åŠ é”çš„è¯»å–æ–¹æ³•
            private static void unLockGet(String key){
                System.out.println("çº¿ç¨‹"+Thread.currentThread().getName()+"\tæ­£åœ¨è¯»å–...o(K_K)o...");
                map.get(key);
                try { TimeUnit.MILLISECONDS.sleep(300); }catch (InterruptedException e) { e.printStackTrace(); }
                System.out.println("çº¿ç¨‹"+Thread.currentThread().getName()+"\tè¯»å–å®Œæˆ...o(p_p)o...âœ…");
            }
    }
æ‰§è¡Œç»“æœ:

    çº¿ç¨‹8	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹3	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹9	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹6	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹5	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹2	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹1	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹7	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹0	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹4	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹5	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹9	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹1	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹7	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹3	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹5	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹2	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹1	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹6	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹8	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹0	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹8	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹7	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹6	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹2	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹9	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹3	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹4	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹4	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹0	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹1	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹3	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹2	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹7	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹9	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹0	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹4	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹5	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹6	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹8	è¯»å–å®Œæˆ...o(p_p)o...âœ…
2ã€åŠ é”åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è¯»å†™

       static  class  MyCache{
        //ReadWriteLockçš„å®ç°ç±»ReentrantReadWriteLock
            private ReentrantReadWriteLock readWriteLock=new ReentrantReadWriteLock();
            //volatile ä¿è¯çº¿ç¨‹çš„å¯è§æ€§ ä¸ä¿è¯åŸå­æ€§ ç¦æ­¢æŒ‡ä»¤é‡æ’
            private volatile Map<String,Object> map=new HashMap<>();
            //å†™å…¥æ–¹æ³•
            private void put(String key ,Object value){
                readWriteLock.writeLock().lock();
                try{
                    //è·å–æ­£åœ¨å†™å…¥çº¿ç¨‹çš„åå­—
                    System.out.println("çº¿ç¨‹"+Thread.currentThread().getName()+"\tæ­£åœ¨å†™å…¥...o(U_U)o...");
                    map.put(key,value);
                    //æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
                    try { TimeUnit.MILLISECONDS.sleep(300); }catch (InterruptedException e) { e.printStackTrace(); }
                    System.out.println("çº¿ç¨‹"+Thread.currentThread().getName()+"\tå†™å…¥å®Œæˆ...o(n_n)o...âœ…");
                }catch(Exception e){
                    e.printStackTrace();
                }finally{
                    readWriteLock.writeLock().unlock();
                }
            }
            //è¯»å–æ–¹æ³•
            public void get(String key){
                readWriteLock.readLock().lock();
                try{
                    System.out.println("çº¿ç¨‹"+Thread.currentThread().getName()+"\tæ­£åœ¨è¯»å–...o(K_K)o...");
                    map.get(key);
                    try { TimeUnit.MILLISECONDS.sleep(300); }catch (InterruptedException e) { e.printStackTrace(); }
                    System.out.println("çº¿ç¨‹"+Thread.currentThread().getName()+"\tè¯»å–å®Œæˆ...o(p_p)o...âœ…");
                }catch(Exception e){
                    e.printStackTrace();
                }finally{
                     readWriteLock.readLock().unlock();
                }
            }
        }
æ‰§è¡Œç»“æœï¼š

    çº¿ç¨‹0	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹0	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹1	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹1	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹2	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹2	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹3	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹3	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹4	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹4	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹5	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹5	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹6	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹6	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹7	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹7	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹8	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹8	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹9	æ­£åœ¨å†™å…¥...o(U_U)o...
    çº¿ç¨‹9	å†™å…¥å®Œæˆ...o(n_n)o...âœ…
    çº¿ç¨‹0	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹2	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹8	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹3	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹5	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹9	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹7	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹6	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹4	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹1	æ­£åœ¨è¯»å–...o(K_K)o...
    çº¿ç¨‹5	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹0	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹3	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹2	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹6	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹7	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹4	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹9	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹8	è¯»å–å®Œæˆ...o(p_p)o...âœ…
    çº¿ç¨‹1	è¯»å–å®Œæˆ...o(p_p)o...âœ…

#### æ€»ç»“ ï¼š
    å¯ä»¥ğŸ˜Œçœ‹å‡ºåœ¨ä¸åŠ é”çš„å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ ä¸èƒ½ä¿è¯**å†™å…¥æ•°æ®**çš„åŸå­æ€§ï¼Œè¿™æ ·æ˜¯ä¸å¯è¡Œçš„ã€‚
    åŠ é”åå¯ä»¥ä¿è¯**å†™å…¥æ•°æ®**çš„åŸå­æ€§ï¼Œä¸è¢«å…¶ä»–çº¿ç¨‹æ‰“æ–­ã€‚

    
####Demoæ•´ä½“Testä¼˜åŒ–

    public class ReadWriteLockDemo {
        //èµ„æºç±»
        static  class  MyCache{
        //ReadWriteLockçš„å®ç°ç±»ReentrantReadWriteLock
            private ReentrantReadWriteLock readWriteLock=new ReentrantReadWriteLock();
            //volatile ä¿è¯çº¿ç¨‹çš„å¯è§æ€§ ä¸ä¿è¯åŸå­æ€§ ç¦æ­¢æŒ‡ä»¤é‡æ’
            private static volatile Map<String,Object> map=new HashMap<>();
            //ä¸åŠ é”çš„å†™å…¥æ–¹æ³•
            private  static void set(String key ,Object value){
                //è·å–æ­£åœ¨å†™å…¥çº¿ç¨‹çš„åå­—
                System.out.println("çº¿ç¨‹"+Thread.currentThread().getName()+"\tæ­£åœ¨å†™å…¥...o(U_U)o...");
                map.put(key,value);
                //æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
                try { TimeUnit.MILLISECONDS.sleep(300); }catch (InterruptedException e) { e.printStackTrace(); }
                System.out.println("çº¿ç¨‹"+Thread.currentThread().getName()+"\tå†™å…¥å®Œæˆ...o(n_n)o...âœ…");
            }
            //ä¸åŠ é”çš„è¯»å–æ–¹æ³•
            private static void unLockGet(String key){
                System.out.println("çº¿ç¨‹"+Thread.currentThread().getName()+"\tæ­£åœ¨è¯»å–...o(K_K)o...");
                map.get(key);
                try { TimeUnit.MILLISECONDS.sleep(300); }catch (InterruptedException e) { e.printStackTrace(); }
                System.out.println("çº¿ç¨‹"+Thread.currentThread().getName()+"\tè¯»å–å®Œæˆ...o(p_p)o...âœ…");
            }
    
            //åŠ é”çš„å†™å…¥æ–¹æ³•
            private void put(String key ,Object value){
                readWriteLock.writeLock().lock();
                try{
                    MyCache.set(key,value);
                }catch(Exception e){
                    e.printStackTrace();
                }finally{
                    readWriteLock.writeLock().unlock();
                }
            }
            //åŠ é”çš„è¯»å–æ–¹æ³•
            public void get(String key){
                readWriteLock.readLock().lock();
                try{
                    MyCache.unLockGet(key);
                }catch(Exception e){
                    e.printStackTrace();
                }finally{
                     readWriteLock.readLock().unlock();
                }
            }
        }
    
    
        public static void main(String[] args) {
            //åˆ›å»ºèµ„æºç±»å¯¹è±¡
            MyCache myCache=new MyCache();
            //åˆ›å»º10ä¸ªçº¿ç¨‹è¿›è¡Œè¯»å†™
            for (int i = 0; i < 10; i++) {
                int finalI = i;
                int finalI1 = i;
                new Thread(()->{
    //                myCache.put(String.valueOf(finalI), finalI);
                    MyCache.set(String.valueOf(finalI), finalI);
    //                myCache.get(String.valueOf(finalI1));
                    MyCache.unLockGet(String.valueOf(finalI1));
                },String.valueOf(i)).start();
            }
    
    
            //ä¸Šé¢ğŸ‘†çš„åä¸ªçº¿ç¨‹å…ˆæ‰§è¡Œ
            try { TimeUnit.SECONDS.sleep(2); }catch (InterruptedException e) { e.printStackTrace(); }
    
        }
    }
æ—¶é—´
    2021å¹´5æœˆ17æ—¥ ä¸Šåˆ24:44
>>>>>>>  æäº¤ Java è¯»å†™é” case
